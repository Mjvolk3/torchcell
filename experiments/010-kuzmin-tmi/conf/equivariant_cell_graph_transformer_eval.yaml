# experiments/010-kuzmin-tmi/conf/equivariant_cell_graph_transformer_eval.yaml
# Full evaluation config for CellGraphTransformer on val and test sets
# Inherits from inference config, overrides for full data collection

defaults:
  - equivariant_cell_graph_transformer_cabbi_000_inference_r2
  - _self_

wandb:
  project: torchcell_010-kuzmin-tmi_equivariant_cell_graph_transformer
  tags: [evaluation, full_dataset]

# KEY OVERRIDES for full data collection:
regression_task:
  plot_sample_ceiling: 1000000  # Large number > dataset size to collect ALL samples
  plot_every_n_epochs: 1        # So val plots trigger (epoch 0 + 1 = 1, 1 % 1 == 0)
  plot_transformer_diagnostics_every_n_epochs: 1  # Always plot diagnostics
  plot_edge_recovery_every_n_epochs: 1            # Always plot edge recovery

# Single GPU for evaluation
trainer:
  devices: 1
  strategy: auto
  max_epochs: 1  # Not used for evaluation, just required

# Evaluation-specific settings
evaluation:
  splits: ["val", "test"]
  threshold: 0.08  # Kuzmin paper: |tau or epsilon| > 0.08, P < 0.05
  save_predictions: true
  results_subdir: "eval"
  # Group identifier from training run (for wandb)
  training_group: "compute-3-3-2036902_bd9e6c666ea1c0e7d1bbb6321fbc4d3bd5f60f100d6dc0e0288cd97e366fc15e"
